<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Times New Roman', Times, serif;
      margin: 0;
      overflow: auto;
    }
    #background {
      font-family: 'Times New Roman', Times, serif;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color:#800000;
      z-index: -1;
    }
    .questionnaire-container {
      font-family: 'Times New Roman', Times, serif;
      display: none;
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      padding: 20px;
      background-color: white;
      z-index: 1;
      }
      .redText {
        color: red
      }
      .blackText {
        color: black
      }
      h1{
        font-family: 'Times New Roman', Times, serif;
        text-decoration: underline;
        text-align: center;
      }
      text{
        font-family: 'Times New Roman', Times, serif;
        text-align: center;
        color: red;
      }
  </style>
</head>
<body onload="showQuestionnaire()">
  <div id="background"></div>
  <div id="questionnaireContainer" class="questionnaire-container"></div>

  <script>
    var order = {"foundHomilyCompelling": '0',"understandingOfMessagePreached": '0',
    "agreementWithHomilyMessage": '0',"DidHomilyChangeYourThinking": '0',"DidHomilyChangeYourFeelings": '0',
    'DirectionOfHomilyFeelingChange': '0','receptivenessToHomily': '0','engagedDuringHomily': '0',
    "effectiveMessageCommunication": '0',"AchievementOfSpeakersGoals": '0',"messageMeaning": '0'};
    
    var saveOrder = ["foundHomilyCompelling","understandingOfMessagePreached","agreementWithHomilyMessage",
    "DidHomilyChangeYourThinking","DidHomilyChangeYourFeelings","DirectionOfHomilyFeelingChange",
    "receptivenessToHomily","engagedDuringHomily","effectiveMessageCommunication",
    "AchievementOfSpeakersGoals","engaging","clarity","organization","contextual","persuasive",
    "theology","accessibility","communication","naturalness","grammar","rhetoric","assembly",
    "volume","rate","pitch","variety","enunciation","pronunciation","posture","control","movement",
    "gestures","eyeContact","emotionalConnection","messageMeaning","generalAdditionalComments",
    "organizationAdditionalComments","languageAdditionalComments","voiceAdditionalComments",
    "additionalCommentsBody","otherComments"];

    // JavaScript code to check the user number and redirect if it's missing
    document.addEventListener('DOMContentLoaded', function() {
        // Retrieve the user number from sessionStorage
        var userNumber = sessionStorage.getItem('userId');

        // Check if the user number is not found
        if (!userNumber) {
            // Redirect to the 'enter_user_number.html' page
            window.location.href = 'enter_user_number.html';
        }
    });
    
    sessionStorage.setItem('userType', 'expert');
    sessionStorage.setItem('experimentSource', 'na');
    sessionStorage.setItem('experimentType', 'av');


    // this block of code generates and displays the form for the user
    // ----------------------------------------------------------------
    // ----------------------------------------------------------------
    // ----------------------------------------------------------------
    function showQuestionnaire() {
      const questionnaireContainer = document.getElementById('questionnaireContainer');
      questionnaireContainer.innerHTML = generateQuestionnaireHTML();

      // Display the questionnaire
      questionnaireContainer.style.display = 'block';
    }


    function generateQuestionnaireHTML() {
      // You can customize the questionnaire HTML generation based on your requirements
      var beginning = `
        <h1>Instructions </h1>
        <p>Please respond to the following questions about the homily you were just shown.
          You must respond to all of the required questions before submitting the form.
          Any unrequired question will be tagged as "optional". 
          Some questions will ask you to rate a particular feature of the homily on a scale from 1 to 6.
          Other questions will require a text entry with a minimum word count. 
          </p>
        
        <h1> Questions </h1>`;

        var question1 = `<!-- Compelling-ness -->
        <label for = "foundHomilyCompelling">
        <p>How compelling did you find this homily?</p>
        </label>
        <label>
          <input type="checkbox" name="foundHomilyCompelling" value="1" onclick="uncheckOthers('foundHomilyCompelling', this)"> Not compelling (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="foundHomilyCompelling" value="2" onclick="uncheckOthers('foundHomilyCompelling', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name="foundHomilyCompelling" value="3" onclick="uncheckOthers('foundHomilyCompelling', this)"> (3)
        </label>
        <br>
        <label>
          <input type="checkbox" name="foundHomilyCompelling" value="4" onclick="uncheckOthers('foundHomilyCompelling', this)"> (4)
        </label>
        <br>
        <label>
          <input type="checkbox" name="foundHomilyCompelling" value="5" onclick="uncheckOthers('foundHomilyCompelling', this)"> (5)
        </label> 
        <br>
        <label>
          <input type="checkbox" name="foundHomilyCompelling" value="6" onclick="uncheckOthers('foundHomilyCompelling', this)"> Very compelling (6)
        </label> 
        <br> <br>`
        

        var question2 = `<!-- Understanding-->
        <label for = "understandingOfMessagePreached">
        <p>Did you understand the message being preached?</p>
        </label>
        <label>
          <input type="checkbox" name="understandingOfMessagePreached" value="1" onclick="uncheckOthers('understandingOfMessagePreached', this)"> Did not understand it (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="understandingOfMessagePreached" value="2" onclick="uncheckOthers('understandingOfMessagePreached', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name="understandingOfMessagePreached" value="3" onclick="uncheckOthers('understandingOfMessagePreached', this)"> (3)
        </label>
        <br>
        <label>
          <input type="checkbox" name="understandingOfMessagePreached" value="4" onclick="uncheckOthers('understandingOfMessagePreached', this)"> (4)
        </label>
        <br>
        <label>
          <input type="checkbox" name="understandingOfMessagePreached" value="5" onclick="uncheckOthers('understandingOfMessagePreached', this)"> (5)
        </label> 
        <br>
        <label>
          <input type="checkbox" name="understandingOfMessagePreached" value="6" onclick="uncheckOthers('understandingOfMessagePreached', this)"> Understood it very well (6)
        </label> 
        <br> <br>`

        var question3 = `<label for="messageMeaning"><p>What did you understand the message of the homily to be? (25 word minimum): </p></label>
        <textarea id="messageMeaning" name="messageMeaning" rows="4" cols="50"></textarea>`

        var question4 = `<!-- Agreement-->
        <label for = "agreementWithHomilyMessage">
        <p>Do you agree with the homily's message?</p>
        </label>
        <label>
            <input type="checkbox" name="agreementWithHomilyMessage" value="1" onclick="uncheckOthers('agreementWithHomilyMessage', this)"> No (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="agreementWithHomilyMessage" value="2" onclick="uncheckOthers('agreementWithHomilyMessage', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name= "agreementWithHomilyMessage" value="3" onclick="uncheckOthers('agreementWithHomilyMessage', this)"> (3)
        </label>
        <br>
        <label>
          <input type="checkbox" name="agreementWithHomilyMessage" value="4" onclick="uncheckOthers('agreementWithHomilyMessage', this)"> (4)
        </label>
        <br>
        <label>
          <input type="checkbox" name="agreementWithHomilyMessage" value="5" onclick="uncheckOthers('agreementWithHomilyMessage', this)"> (5)
        </label>
        <br>
        <label>
          <input type="checkbox" name="agreementWithHomilyMessage" value="6" onclick="uncheckOthers('agreementWithHomilyMessage', this)"> Yes (6)
        </label>
        <br> <br>`

        var question5 = `<!-- Change in Thinking-->
        <label for = "DidHomilyChangeYourThinking">
        <p>Did the homily change your thinking about this message?</p>
        </label>
        <label>
            <input type="checkbox" name="DidHomilyChangeYourThinking" value="1" onclick="uncheckOthers('DidHomilyChangeYourThinking', this)"> No (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="DidHomilyChangeYourThinking" value="2" onclick="uncheckOthers('DidHomilyChangeYourThinking', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name= "DidHomilyChangeYourThinking" value="3" onclick="uncheckOthers('DidHomilyChangeYourThinking', this)"> (3)
        </label>
        <br>
        <label>
          <input type="checkbox" name="DidHomilyChangeYourThinking" value="4" onclick="uncheckOthers('DidHomilyChangeYourThinking', this)"> (4)
        </label>
        <br>
        <label>
          <input type="checkbox" name="DidHomilyChangeYourThinking" value="5" onclick="uncheckOthers('DidHomilyChangeYourThinking', this)"> (5)
        </label>
        <br>
        <label>
          <input type="checkbox" name="DidHomilyChangeYourThinking" value="6" onclick="uncheckOthers('DidHomilyChangeYourThinking', this)"> Yes (6)
        </label>
        <br> <br>`

        // <!-- Accepting of the message
        // <p>6. Were you more or less accepting of the message being preached after watching the homily?</p>
        // <label>
        //     <input type="checkbox" name="accepting" value="Much less accepting" onclick="uncheckOthers('accepting', this)"> Much less accepting
        // </label>
        // <br>
        // <label>
        //   <input type="checkbox" name="accepting" value="Somewhat less accepting" onclick="uncheckOthers('accepting', this)"> Somewhat less accepting
        // </label>
        // <br>
        // <label>
        //   <input type="checkbox" name= "accepting" value="Just as accepting as I was before watching the homily" onclick="uncheckOthers('accepting', this)"> Just as accepting as I was before watching the homily
        // </label>
        // <br>
        // <label>
        //   <input type="checkbox" name="accepting" value="Somewhat more accepting" onclick="uncheckOthers('accepting', this)"> Somewhat more accepting
        // </label>
        // <br>
        // <label>
        //   <input type="checkbox" name="accepting" value="Much more accepting" onclick="uncheckOthers('accepting', this)"> Much more accepting
        // </label> -->


        var question6 = `<!-- Change in Feelings -->
        <label for = "DidHomilyChangeYourFeelings">
        <p>Did the homily change your feelings in any way?</p>
        </label>
        <label>
            <input type="checkbox" name="DidHomilyChangeYourFeelings" value="1" onclick="uncheckOthers('DidHomilyChangeYourFeelings', this)"> No (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="DidHomilyChangeYourFeelings" value="2" onclick="uncheckOthers('DidHomilyChangeYourFeelings', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name= "DidHomilyChangeYourFeelings" value="3" onclick="uncheckOthers('DidHomilyChangeYourFeelings', this)"> (3)
        </label>
        <br>
        <label>
          <input type="checkbox" name="DidHomilyChangeYourFeelings" value="4" onclick="uncheckOthers('DidHomilyChangeYourFeelings', this)"> (4)
        </label>
        <br>
        <label>
          <input type="checkbox" name="DidHomilyChangeYourFeelings" value="5" onclick="uncheckOthers('DidHomilyChangeYourFeelings', this)"> (5)
        </label>
        <br>
        <label>
          <input type="checkbox" name="DidHomilyChangeYourFeelings" value="6" onclick="uncheckOthers('DidHomilyChangeYourFeelings', this)"> Yes (6)
        </label>
        <br> <br>`

        var question7 = `<!-- Direction of feeling change-->
        <label for = "DirectionOfHomilyFeelingChange">
        <p>Was the homily's effect on your feelings positive or negative?</p>
        </label>
        <label>
            <input type="checkbox" name="DirectionOfHomilyFeelingChange" value="1" onclick="uncheckOthers('DirectionOfHomilyFeelingChange', this)"> Negative (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="DirectionOfHomilyFeelingChange" value="2" onclick="uncheckOthers('DirectionOfHomilyFeelingChange', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name= "DirectionOfHomilyFeelingChange" value="3" onclick="uncheckOthers('DirectionOfHomilyFeelingChange', this)"> (3)
        </label>
        <br>
        <label>
          <input type="checkbox" name="DirectionOfHomilyFeelingChange" value="4" onclick="uncheckOthers('DirectionOfHomilyFeelingChange', this)"> (4)
        </label>
        <br>
        <label>
          <input type="checkbox" name="DirectionOfHomilyFeelingChange" value="5" onclick="uncheckOthers('DirectionOfHomilyFeelingChange', this)"> (5)
        </label>
        <br>
        <label>
          <input type="checkbox" name="DirectionOfHomilyFeelingChange" value="6" onclick="uncheckOthers('DirectionOfHomilyFeelingChange', this)"> Positive (6)
        </label>
        <br> <br>`

        var question8 = `<!-- receptiveness-->
        <label for = "receptivenessToHomily">
        <p>Do you believe the congregation would have been receptive to this homily?</p>
        </label>
        <label>
            <input type="checkbox" name="receptivenessToHomily" value="1" onclick="uncheckOthers('receptivenessToHomily', this)"> No (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="receptivenessToHomily" value="2" onclick="uncheckOthers('receptivenessToHomily', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name= "receptivenessToHomily" value="3" onclick="uncheckOthers('receptivenessToHomily', this)"> (3)
        </label>
        <br>
        <label>
          <input type="checkbox" name="receptivenessToHomily" value="4" onclick="uncheckOthers('receptivenessToHomily', this)"> (4)
        </label>
        <br>
        <label>
          <input type="checkbox" name="receptivenessToHomily" value="5" onclick="uncheckOthers('receptivenessToHomily', this)"> (5)
        </label>
        <br>
        <label>
          <input type="checkbox" name="receptivenessToHomily" value="6" onclick="uncheckOthers('receptivenessToHomily', this)"> Yes (6)
        </label>`


        var question9 = `<!-- Engagement-->
        <label for = "engagedDuringHomily">
        <p>Did you feel engaged while listening the homily?</p>
        </label>
        <label>
            <input type="checkbox" name="engagedDuringHomily" value="1" onclick="uncheckOthers('engagedDuringHomily', this)"> No (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="engagedDuringHomily" value="2" onclick="uncheckOthers('engagedDuringHomily', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name= "engagedDuringHomily" value="3" onclick="uncheckOthers('engagedDuringHomily', this)"> (3)
        </label>
        <br>
        <label>
          <input type="checkbox" name="engagedDuringHomily" value="4" onclick="uncheckOthers('engagedDuringHomily', this)"> (4)
        </label>
        <br>
        <label>
          <input type="checkbox" name="engagedDuringHomily" value="5" onclick="uncheckOthers('engagedDuringHomily', this)"> (5)
        </label>
        <br>
        <label>
          <input type="checkbox" name="engagedDuringHomily" value="6" onclick="uncheckOthers('engagedDuringHomily', this)"> Yes (6)
        </label>
        <br> <br>`

        var question10 = `<!-- Effectiveness -->
        <label for = "effectiveMessageCommunication">
        <p>Was the message effectively communicated?</p>
        </label>
        <label>
            <input type="checkbox" name="effectiveMessageCommunication" value="1" onclick="uncheckOthers('effectiveMessageCommunication', this)"> No (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="effectiveMessageCommunication" value="2" onclick="uncheckOthers('effectiveMessageCommunication', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name= "effectiveMessageCommunication" value="3" onclick="uncheckOthers('effectiveMessageCommunication', this)"> (3)
        </label>
        <br>
        <label>
          <input type="checkbox" name="effectiveMessageCommunication" value="4" onclick="uncheckOthers('effectiveMessageCommunication', this)"> (4)
        </label>
        <br>
        <label>
          <input type="checkbox" name="effectiveMessageCommunication" value="5" onclick="uncheckOthers('effectiveMessageCommunication', this)"> (5)
        </label>
        <br>
        <label>
          <input type="checkbox" name="effectiveMessageCommunication" value="6" onclick="uncheckOthers('effectiveMessageCommunication', this)"> Yes (6)
        </label>
        <br> <br>`

        var question11 = `<!-- Achievement of speaker's goals-->
        <label for = "AchievementOfSpeakersGoals">
        <p>Do you feel that the speaker achieved their goals in this homily?</p>
        </label>
        <label>
            <input type="checkbox" name="AchievementOfSpeakersGoals" value="1" onclick="uncheckOthers('AchievementOfSpeakersGoals', this)"> No (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="AchievementOfSpeakersGoals" value="2" onclick="uncheckOthers('AchievementOfSpeakersGoals', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name= "AchievementOfSpeakersGoals" value="3" onclick="uncheckOthers('AchievementOfSpeakersGoals', this)"> (3)
        </label>
        <br>
        <label>
          <input type="checkbox" name="AchievementOfSpeakersGoals" value="4" onclick="uncheckOthers('AchievementOfSpeakersGoals', this)"> (4)
        </label>
        <br>
        <label>
          <input type="checkbox" name="AchievementOfSpeakersGoals" value="5" onclick="uncheckOthers('AchievementOfSpeakersGoals', this)"> (5)
        </label>
        <br>
        <label>
          <input type="checkbox" name="AchievementOfSpeakersGoals" value="6" onclick="uncheckOthers('AchievementOfSpeakersGoals', this)"> Yes (6)
        </label>`


        // <!--
        // // <br>
        // // <br>
        // // <label for="freeform">12. How do you believe that the audience received the message of this Homily? How receptive do you anticipate they would have been to its message? (25 word minimum): </label>
        // // <br>
        // // <textarea id="receptiveness" name="freeform" rows="4" cols="50"></textarea>
        // -->


        var ending = `<br>
        <br>
        <label for="freeform">Additional Comments (optional):</label>
        <br>
        <textarea id="generalAdditionalComments" name="freeform" rows="4" cols="50"></textarea>

        <h1>Organization and Content</h1>

        <label for = "engaging">
        <p><b>Engaging Introduction</b></p>
        </label>
        <label>
            <input type="checkbox" name="engaging" value="1" onclick="uncheckOthers('engaging', this)"> Worst (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="engaging" value="2" onclick="uncheckOthers('engaging', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name= "engaging" value="3" onclick="uncheckOthers('engaging', this)"> (3)
        </label>
        <br>
        <label>
          <input type="checkbox" name="engaging" value="4" onclick="uncheckOthers('engaging', this)"> (4)
        </label>
        <br>
        <label>
          <input type="checkbox" name="engaging" value="5" onclick="uncheckOthers('engaging', this)"> (5)
        </label>
        <br>
        <label>
          <input type="checkbox" name="engaging" value="6" onclick="uncheckOthers('engaging', this)"> Best (6)
        </label>

        <label for = "clarity">
        <p><b>Main Points Clearly Stated</b></p>
        </label>
        <label>
            <input type="checkbox" name="clarity" value="1" onclick="uncheckOthers('clarity', this)"> Worst (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="clarity" value="2" onclick="uncheckOthers('clarity', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name= "clarity" value="3" onclick="uncheckOthers('clarity', this)"> (3)
        </label>
        <br>
        <label>
          <input type="checkbox" name="clarity" value="4" onclick="uncheckOthers('clarity', this)"> (4)
        </label>
        <br>
        <label>
          <input type="checkbox" name="clarity" value="5" onclick="uncheckOthers('clarity', this)"> (5)
        </label>
        <br>
        <label>
          <input type="checkbox" name="clarity" value="6" onclick="uncheckOthers('clarity', this)"> Best (6)
        </label>

        <label for = "organization">
        <p><b>Well Organized</b></p>
        </label>
        <label>
            <input type="checkbox" name="organization" value="1" onclick="uncheckOthers('organization', this)"> Worst (1)
        </label>
        <br>
        <label>
          <input type="checkbox" name="organization" value="2" onclick="uncheckOthers('organization', this)"> (2)
        </label>
        <br>
        <label>
          <input type="checkbox" name= "organization" value="3" onclick="uncheckOthers('organization', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="organization" value="4" onclick="uncheckOthers('organization', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="organization" value="5" onclick="uncheckOthers('organization', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="organization" value="6" onclick="uncheckOthers('organization', this)"> Best (6)
        </label>

        <label for = "contextual">
        <p><b>Appropriately Contextual</b></p>
        </label>
        <label>
            <input type="checkbox" name="contextual" value="1" onclick="uncheckOthers('contextual', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="contextual" value="2" onclick="uncheckOthers('contextual', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "contextual" value="3" onclick="uncheckOthers('contextual', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="contextual" value="4" onclick="uncheckOthers('contextual', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="contextual" value="5" onclick="uncheckOthers('contextual', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="contextual" value="6" onclick="uncheckOthers('contextual', this)"> Best (6)
        </label>

        <label for = "persuasive">
        <p><b>Engaging/Persuasive</b></p>
        </label>
        <label>
            <input type="checkbox" name="persuasive" value="1" onclick="uncheckOthers('persuasive', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="persuasive" value="2" onclick="uncheckOthers('persuasive', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "persuasive" value="3" onclick="uncheckOthers('persuasive', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="persuasive" value="4" onclick="uncheckOthers('persuasive', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="persuasive" value="5" onclick="uncheckOthers('persuasive', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="persuasive" value="6" onclick="uncheckOthers('persuasive', this)"> Best (6)
        </label>

        <label for = "theology">
        <p><b>Theological/Liturgical Literacy</b></p>
        </label>
        <label>
            <input type="checkbox" name="theology" value="1" onclick="uncheckOthers('theology', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="theology" value="2" onclick="uncheckOthers('theology', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "theology" value="3" onclick="uncheckOthers('theology', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="theology" value="4" onclick="uncheckOthers('theology', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="theology" value="5" onclick="uncheckOthers('theology', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="theology" value="6" onclick="uncheckOthers('theology', this)"> Best (6)
        </label>

        <label for = "accessibility">
        <p><b>Pastoral Accessibility</b></p>
        </label>
        <label>
            <input type="checkbox" name="accessibility" value="1" onclick="uncheckOthers('accessibility', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="accessibility" value="2" onclick="uncheckOthers('accessibility', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "accessibility" value="3" onclick="uncheckOthers('accessibility', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="accessibility" value="4" onclick="uncheckOthers('accessibility', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="accessibility" value="5" onclick="uncheckOthers('accessibility', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="accessibility" value="6" onclick="uncheckOthers('accessibility', this)"> Best (6)
        </label>

        <br>
        <br>
        <label for="freeform">Additional Comments (optional):</label>
        <br>

        <textarea id="organizationAdditionalComments" name="freeform" rows="4" cols="50"></textarea>




        
        <h1>Language</h1>

        <label for = "communication">
        <p><b>Appropriate to Oral Communication</b></p>
        </label>
        <label>
            <input type="checkbox" name="communication" value="1" onclick="uncheckOthers('communication', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="communication" value="2" onclick="uncheckOthers('communication', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "communication" value="3" onclick="uncheckOthers('communication', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="communication" value="4" onclick="uncheckOthers('communication', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="communication" value="5" onclick="uncheckOthers('communication', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="communication" value="6" onclick="uncheckOthers('communication', this)"> Best (6)
        </label>

        <label for = "naturalness">
        <p><b>Naturalness</b></p>
        </label>
        <label>
            <input type="checkbox" name="naturalness" value="1" onclick="uncheckOthers('naturalness', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="naturalness" value="2" onclick="uncheckOthers('naturalness', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "naturalness" value="3" onclick="uncheckOthers('naturalness', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="naturalness" value="4" onclick="uncheckOthers('naturalness', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="naturalness" value="5" onclick="uncheckOthers('naturalness', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="naturalness" value="6" onclick="uncheckOthers('naturalness', this)"> Best (6)
        </label>

        <label for = "grammar">
        <p><b>Grammar</b></p>
        </label>
        <label>
            <input type="checkbox" name="grammar" value="1" onclick="uncheckOthers('grammar', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="grammar" value="2" onclick="uncheckOthers('grammar', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "grammar" value="3" onclick="uncheckOthers('grammar', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="grammar" value="4" onclick="uncheckOthers('grammar', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="grammar" value="5" onclick="uncheckOthers('grammar', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="grammar" value="6" onclick="uncheckOthers('grammar', this)"> Best (6)
        </label>

        <label for = "rhetoric">
        <p><b>Rhetorical/Poetic Richness</b></p>
        </label>
        <label>
            <input type="checkbox" name="rhetoric" value="1" onclick="uncheckOthers('rhetoric', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="rhetoric" value="2" onclick="uncheckOthers('rhetoric', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "rhetoric" value="3" onclick="uncheckOthers('rhetoric', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="rhetoric" value="4" onclick="uncheckOthers('rhetoric', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="rhetoric" value="5" onclick="uncheckOthers('rhetoric', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="rhetoric" value="6" onclick="uncheckOthers('rhetoric', this)"> Best (6)
        </label>

        <label for = "assembly">
        <p><b>Accessibility to Assembly</b></p>
        </label>
        <label>
            <input type="checkbox" name="assembly" value="1" onclick="uncheckOthers('assembly', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="assembly" value="2" onclick="uncheckOthers('assembly', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "assembly" value="3" onclick="uncheckOthers('assembly', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="assembly" value="4" onclick="uncheckOthers('assembly', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="assembly" value="5" onclick="uncheckOthers('assembly', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="assembly" value="6" onclick="uncheckOthers('assembly', this)"> Best (6)
        </label>

        <br>
        <br>
        <label for="freeform">Additional Comments (optional):</label>
        <br>

        <textarea id="languageAdditionalComments" name="freeform" rows="4" cols="50"></textarea>




        <h1>Voice</h1>

        <label for = "volume">
        <p><b>Volume</b></p>
        </label>
        <label>
            <input type="checkbox" name="volume" value="1" onclick="uncheckOthers('volume', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="volume" value="2" onclick="uncheckOthers('volume', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "volume" value="3" onclick="uncheckOthers('volume', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="volume" value="4" onclick="uncheckOthers('volume', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="volume" value="5" onclick="uncheckOthers('volume', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="volume" value="6" onclick="uncheckOthers('volume', this)"> Best (6)
        </label>

        <label for = "rate">
        <p><b>Rate of Speech/Pacing</b></p>
        </label>
        <label>
            <input type="checkbox" name="rate" value="1" onclick="uncheckOthers('rate', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="rate" value="2" onclick="uncheckOthers('rate', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "rate" value="3" onclick="uncheckOthers('rate', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="rate" value="4" onclick="uncheckOthers('rate', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="rate" value="5" onclick="uncheckOthers('rate', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="rate" value="6" onclick="uncheckOthers('rate', this)"> Best (6)
        </label>

        <label for = "pitch">
        <p><b>Pitch</b></p>
        </label>
        <label>
            <input type="checkbox" name="pitch" value="1" onclick="uncheckOthers('pitch', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="pitch" value="2" onclick="uncheckOthers('pitch', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "pitch" value="3" onclick="uncheckOthers('pitch', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="pitch" value="4" onclick="uncheckOthers('pitch', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="pitch" value="5" onclick="uncheckOthers('pitch', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="pitch" value="6" onclick="uncheckOthers('pitch', this)"> Best (6)
        </label>

        <label for = "variety">
        <p><b>Vocal Variety</b></p>
        </label>
        <label>
            <input type="checkbox" name="variety" value="1" onclick="uncheckOthers('variety', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="variety" value="2" onclick="uncheckOthers('variety', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "variety" value="3" onclick="uncheckOthers('variety', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="variety" value="4" onclick="uncheckOthers('variety', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="variety" value="5" onclick="uncheckOthers('variety', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="variety" value="6" onclick="uncheckOthers('variety', this)"> Best (6)
        </label>

        <label for = "enunciation">
        <p><b>Enunciation</b></p>
        </label>
        <label>
            <input type="checkbox" name="enunciation" value="1" onclick="uncheckOthers('enunciation', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="enunciation" value="2" onclick="uncheckOthers('enunciation', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "enunciation" value="3" onclick="uncheckOthers('enunciation', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="enunciation" value="4" onclick="uncheckOthers('enunciation', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="enunciation" value="5" onclick="uncheckOthers('enunciation', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="enunciation" value="6" onclick="uncheckOthers('enunciation', this)"> Best (6)
        </label>

        <label for = "pronunciation">
        <p><b>Pronunciation</b></p>
        </label>
        <label>
            <input type="checkbox" name="pronunciation" value="1" onclick="uncheckOthers('pronunciation', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="pronunciation" value="2" onclick="uncheckOthers('pronunciation', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name= "pronunciation" value="3" onclick="uncheckOthers('pronunciation', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="pronunciation" value="4" onclick="uncheckOthers('pronunciation', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="pronunciation" value="5" onclick="uncheckOthers('pronunciation', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="pronunciation" value="6" onclick="uncheckOthers('pronunciation', this)"> Best (6)
        </label>
        <br>
        <br>
        <label for="freeform">Additional Comments (optional):</label>
        <br>

        <textarea id="voiceAdditionalComments" name="freeform" rows="4" cols="50"></textarea>

        </label>
        <h1>Body</h1>

        <!-- Posture -->
        <label for = "posture">
        <p><b>Posture</b></p>
        </label>
        <label>
          <input type="checkbox" name="posture" value="1" onclick="uncheckOthers('posture', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="posture" value="2" onclick="uncheckOthers('posture', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name="posture" value="3" onclick="uncheckOthers('posture', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="posture" value="4" onclick="uncheckOthers('posture', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="posture" value="5" onclick="uncheckOthers('posture', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="posture" value="6" onclick="uncheckOthers('posture', this)"> Best (6)
        </label>

        <!-- Control -->
        <label for = "control">
        <p><b>Control</b></p>
        </label>
        <label>
          <input type="checkbox" name="control" value="1" onclick="uncheckOthers('control', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="control" value="2" onclick="uncheckOthers('control', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name="control" value="3" onclick="uncheckOthers('control', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="control" value="4" onclick="uncheckOthers('control', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="control" value="5" onclick="uncheckOthers('control', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="control" value="6" onclick="uncheckOthers('control', this)"> Best (6)
        </label>

        <!-- Movement -->
        <label for = "movement">
        <p><b>Effectiveness of Movement</b></p>
        </label>
        <label>
          <input type="checkbox" name="movement" value="1" onclick="uncheckOthers('movement', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="movement" value="2" onclick="uncheckOthers('movement', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name="movement" value="3" onclick="uncheckOthers('movement', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="movement" value="4" onclick="uncheckOthers('movement', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="movement" value="5" onclick="uncheckOthers('movement', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="movement" value="6" onclick="uncheckOthers('movement', this)"> Best (6)
        </label>

        <!-- gestures -->
        <label for = "gestures">
        <p><b>Effectiveness of Gestures</b></p>
        </label>
        <label>
          <input type="checkbox" name="gestures" value="1" onclick="uncheckOthers('gestures', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="gestures" value="2" onclick="uncheckOthers('gestures', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name="gestures" value="3" onclick="uncheckOthers('gestures', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="gestures" value="4" onclick="uncheckOthers('gestures', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="gestures" value="5" onclick="uncheckOthers('gestures', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="gestures" value="6" onclick="uncheckOthers('gestures', this)"> Best (6)
        </label>

        <!-- eye contact -->
        <label for = "eyeContact">
        <p><b>Effectiveness of Eye Contact</b></p>
        </label>
        <label>
          <input type="checkbox" name="eyeContact" value="1" onclick="uncheckOthers('eyeContact', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="eyeContact" value="2" onclick="uncheckOthers('eyeContact', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name="eyeContact" value="3" onclick="uncheckOthers('eyeContact', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="eyeContact" value="4" onclick="uncheckOthers('eyeContact', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="eyeContact" value="5" onclick="uncheckOthers('eyeContact', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="eyeContact" value="6" onclick="uncheckOthers('eyeContact', this)"> Best (6)
        </label>

        <!-- Emotional Connection -->
        <label for = "emotionalConnection">
        <p><b>Emotional Connection</b></p>
        </label>
        <label>
          <input type="checkbox" name="emotionalConnection" value="1" onclick="uncheckOthers('emotionalConnection', this)"> Worst (1)
        </label><br>
        <label>
          <input type="checkbox" name="emotionalConnection" value="2" onclick="uncheckOthers('emotionalConnection', this)"> (2)
        </label><br>
        <label>
          <input type="checkbox" name="emotionalConnection" value="3" onclick="uncheckOthers('emotionalConnection', this)"> (3)
        </label><br>
        <label>
          <input type="checkbox" name="emotionalConnection" value="4" onclick="uncheckOthers('emotionalConnection', this)"> (4)
        </label><br>
        <label>
          <input type="checkbox" name="emotionalConnection" value="5" onclick="uncheckOthers('emotionalConnection', this)"> (5)
        </label><br>
        <label>
          <input type="checkbox" name="emotionalConnection" value="6" onclick="uncheckOthers('emotionalConnection', this)"> Best (6)
        </label>
        
        <br>
        <br>
        <label for="freeform">Additional Comments (optional):</label>
        <br>

        <textarea id="additionalCommentsBody" name="freeform" rows="4" cols="50"></textarea>


        </label>
        <br>
        <br>
        <label for="otherComments">Other Valuable Commendations/Reccomendations or technical issues you encountered (optional):</label>
        <br>

        <textarea id="otherComments" name="otherComments" rows="4" cols="50"></textarea>

        <br>
        <br>
        <center>
          <text id = 'errorMessage'></text>
        </center>

        <br>
        <center>
          <button onclick="submitForm()">Submit</button>
        </center>
        <br>`;
        // list of the questions we ask (if you add more questions, then follow the format above and add to this list)
      var questionTuples = [["foundHomilyCompelling", question1], ["understandingOfMessagePreached", question2],
       ["messageMeaning", question3], ["agreementWithHomilyMessage", question4], 
       ["DidHomilyChangeYourThinking", question5], ['DidHomilyChangeYourFeelings', question6], 
       ['DirectionOfHomilyFeelingChange', question7], ['receptivenessToHomily', question8], 
       ["engagedDuringHomily", question9], ["effectiveMessageCommunication", question10], 
       ["AchievementOfSpeakersGoals", question11]];
      for (let i = questionTuples.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1)); // Generate random index from 0 to i
        [questionTuples[i], questionTuples[j]] = [questionTuples[j], questionTuples[i]]; // Swap elements at i and j indices
      }

      var questions = [];
      for (let i = 0; i <= questionTuples.length - 1; i++) {
        questions.push(questionTuples[i][1]);
        questionTuples[i].push(String(i + 1));
      }
      for (let i = 0; i <= questionTuples.length - 1; i++) {
        order[questionTuples[i][0]] = questionTuples[i][2];
      }
      
      finalHTML = beginning + questions.join('') + ending;
      return finalHTML
    }
    // ----------------------------------------------------------------
    // ----------------------------------------------------------------
    // ----------------------------------------------------------------



  
    // this block of code checks if user has completed the form and if so,
    // sends that data to the server to be stored as a csv file. 
    // If not, an error message is displayed.
    // ---------------------------------------------------------------------
    // ---------------------------------------------------------------------
    // ---------------------------------------------------------------------

    // submits the form and send data if complete, otherwise gives error message
    function submitForm() {
      const isValid = validateForm();
      if (!isValid) {
        const errorMessage = document.getElementById('errorMessage');
        errorMessage.textContent = 'You must respond to all questions and meet all minimum required word counts';
        setTimeout(function() {
          errorMessage.textContent = '';
        }, 3000);
      }
      else{         
        // update viewed homilies on the server for that user and print server response
        updateViewedHomilies().then(response => {
          // get header and data and store as csv
          header = getHeader();
          data = getData();
          sendResults(header, data);
          updateHomilyCount();

          // check if expert has reviewed all homilies and redirect appropriately
          checkHomiliesCompleted().then(completed => {
          console.log(completed);
          if (!completed){
            window.location.href = 'new_homily_wait_screen.html';
          }
          else{
            window.location.href = 'preaching_experience.html';
          }
          });
        });
      }
    }


    // validates that the user answered all questions
    // (helper for submit form)
    function validateForm() {
      const checkboxes = document.querySelectorAll('input[type="checkbox"]');
      let valid = true;
      let name_dict = {};
      let unanswered = [];
      let answered = [];

      // check for required textboxes meeting minimum word count
      const responseHomilyMessage = document.getElementById("messageMeaning").value;
      if (wordCount(responseHomilyMessage) < 25){
        //console.log('messageMeaning');
        unanswered.push('messageMeaning');
        valid = false;
      } else {
        answered.push('messageMeaning');
      }

      // collect all checkboxes of a given name into a list
      for (let i = 0; i < checkboxes.length; i++){
        name = checkboxes[i].name;
        try {
          name_dict[name].push(checkboxes[i]);
        } catch (error){
          name_dict[name] = [checkboxes[i]];
        }}
        
      for (const [key, value] of Object.entries(name_dict)){
        let responded = false;
        for (let i = 0; i < value.length; i++){
          if (value[i].checked){
            responded = true;}}

          if (!responded){
            if (!unanswered.includes(key)) {
              //console.log(key);
              unanswered.push(key);
            }
            valid = false;
            //break;
          } else {
            if (!answered.includes(key)){
              //console.log(key);
            answered.push(key);
            }
          }
        }
      
      colorAnsweredAndUnanswered(answered, unanswered);
      //console.log('here');
      return valid;
    }

    // highlights unanswered questions in red and answered questions in black
    function colorAnsweredAndUnanswered(answered, unanswered) {
      
      // color all of the unanswered questions in red
      for (let i = 0; i < unanswered.length; i++) {
        if (unanswered[i] == 'messageMeaning') {
          console.log('here');
          let questionText = document.querySelector(`label[for="${unanswered[i]}"]`).querySelector('p');
          questionText.classList.remove('blackText');
          questionText.classList.add('redText');
          continue;
        } 
        console.log(unanswered[i])
        let checkboxes = document.querySelectorAll(`input[type="checkbox"][name="${unanswered[i]}"]`);
        let questionText = document.querySelector(`label[for="${unanswered[i]}"]`).querySelector('p');
        questionText.classList.remove('blackText');
        questionText.classList.add('redText');
        for (j = 0; j < checkboxes.length; j++ ) {
          checkboxes[j].closest('label').classList.remove('blackText');
          checkboxes[j].closest('label').classList.add('redText');
        }
      }

      // color all of the answered questions in black
      console.log(answered.length)
      for (let i = 0; i < answered.length; i++) {
        if (answered[i] == 'messageMeaning') {
          console.log('here');
          let questionText = document.querySelector(`label[for="${answered[i]}"]`).querySelector('p');
          questionText.classList.remove('redText');
          questionText.classList.add('blackText');
          continue;
        } 
        let checkboxes = document.querySelectorAll(`input[type="checkbox"][name="${answered[i]}"]`);
        let questionText = document.querySelector(`label[for="${answered[i]}"]`).querySelector('p');
        questionText.classList.remove('redText');
        questionText.classList.add('blackText');
        for (j = 0; j < checkboxes.length; j++ ) {
          checkboxes[j].closest('label').classList.remove('redText');
          checkboxes[j].closest('label').classList.add('blackText');
        }
      }
    }


    // returns the word count of a string
    // (helper for validate form)
    function wordCount(string){
      const words = string.split(" ");
      wordcount = 0;
      for (let i = 0; i < words.length; i++){
        if (!words[i] == ' ') {
          wordcount += 1;
        }
      }
      return wordcount;
    }
    
    
    // sends the user response to the server to be stored as a csv
    // (helper for submit form)
    async function sendResults(header, data){
      const userId = sessionStorage.getItem('userId');
      const userType = sessionStorage.getItem('userType');
      const homilyId = sessionStorage.getItem('homilyId');
      const experimentSource = sessionStorage.getItem('experimentSource');
      const experimentType = sessionStorage.getItem('experimentType');
      const url = `/api/storeQuestionnaireResults`;

      // package the results in an Object to later stringify
      let oldResults = {}
      for (let i = 0; i < header.length; i++){
        oldResults[String(header[i])] = String(data[i]);
      }

      let results = {};
      saveOrder.forEach(questionName => {
        results[questionName] = oldResults[questionName];
      });

      const response = await fetch(url, {
        method: 'POST',
        headers: {'Content-Type' : 'application/json'},
        body: JSON.stringify({
              'userId' : userId, 
              'userType' : userType,
              'homilyId' : homilyId,
              'experimentSource' : experimentSource,
              'experimentType' : experimentType,
              'results' : JSON.stringify(results),
              'order': JSON.stringify(order)})
        });
        return await response.json();
      } 
      
    // updates the total homily count on the server
    // helper for submitForm()
    async function updateHomilyCount() {
      const homilyId = sessionStorage.getItem('homilyId');
      const userType = sessionStorage.getItem('userType');
      const experimentSource = sessionStorage.getItem('experimentSource');
      const experimentType = sessionStorage.getItem('experimentType');
      const url = `/api/updateHomilyCount`;

      const response = await fetch(url, {
        method: 'POST',
        headers: {'Content-Type' : 'application/json'},
        body: JSON.stringify({'homilyId' : String(homilyId), 'userType': userType, 'experimentSource' : experimentSource, 'experimentType' : experimentType})
      });
      return await response.json();
    }


    // checks if the expert has viewed all of the homilies for proper redirection
    // (helper for submitForm)
    async function checkHomiliesCompleted(){
      const userId = sessionStorage.getItem('userId');
      const userType = sessionStorage.getItem('userType');
      const experimentSource = sessionStorage.getItem('experimentSource');
      const experimentType = sessionStorage.getItem('experimentType');
      
      const url = `/api/allHomiliesViewed/${userId}/${userType}/${experimentSource}/${experimentType}`;

      try{
        const response = await fetch(url);
        if (!response.ok){
              throw new Error('HTTP error! status: ${completed.status}');
          }
          const completed = await response.json()
          return await completed.done;
      } catch (error) {
          console.error("Unable to fetch completion data");
          return null;
        }
    }

    
    // update the list of homilies that the user has seen on the server 
    // (helper for "submitForm()")
    async function updateViewedHomilies(){
      const userId = sessionStorage.getItem('userId');
      const userType = sessionStorage.getItem('userType');
      const homilyId = sessionStorage.getItem('homilyId');
      const experimentSource = sessionStorage.getItem('experimentSource');
      const experimentType = sessionStorage.getItem('experimentType');

      console.log('session storage: ', userId, userType, homilyId)
      const url = '/api/updateViewedHomilies';

      const response = await fetch(url, {
        method: 'POST',
        headers: {'Content-Type' : 'application/json'},
        body: JSON.stringify({
              'userId' : userId, 
              'userType' : userType,
              'experimentSource' : experimentSource,
              'experimentType' : experimentType,
              'homilyId' : homilyId})
      });

      return await response.json();
    }


    // gets the header for the soon-to-be csv file on the server
    // (helper for "submitForm())
    function getHeader(){
      let homilyName = sessionStorage.getItem('homilyId');
      let checkboxNames = [];
      let textboxNames = [];
      const checkboxes = document.querySelectorAll('input[type="checkbox"]');
      const textboxes = document.querySelectorAll('textarea');

      // collect all check box names in order
      for (let i = 0; i < checkboxes.length; i++){
        name = checkboxes[i].name;
        if (checkboxNames.includes(name)){
          continue;
        }
        checkboxNames.push(name);
      }

      // collect all textbox names
      for (let i = 0; i < textboxes.length; i++){
        name = textboxes[i].id;
        textboxNames.push(name);
      }

      return checkboxNames.concat(textboxNames);
    }

    
    // gets the header for the soon-to-be csv file on the server
    // (helper for "submitForm())
    function getData(){
      let name_dict = {};
      let checkboxData = [];
      let textboxData = [];
      const checkboxes = document.querySelectorAll('input[type="checkbox"]');
      const textboxes = document.querySelectorAll('textarea');

      // collect all checkboxes of a given name into a list
      for (let i = 0; i < checkboxes.length; i++){
        name = checkboxes[i].name;
        try {
          name_dict[name].push(checkboxes[i]);
          } catch (error){
            name_dict[name] = [checkboxes[i]];}}
            
        // iterate over all checkbox questions
        for (const [key, value] of Object.entries(name_dict)){
          // iterate over each checkbox in a given question
          for (let i = 0; i < value.length; i++){
            let option = value[i];
            // add all values of checked checkboxes to the list
            if (option.checked){
              checkboxData.push(String(option.value));}}}

          // iterate over all textbox questions
          for (let i = 0; i < textboxes.length; i++){
            let textEntry = textboxes[i].value;
            textboxData.push(textEntry);}

      return checkboxData.concat(textboxData); 
    }

    // ---------------------------------------------------------------------
    // ---------------------------------------------------------------------
    // ---------------------------------------------------------------------


    
    // ensures that the user has at most one checkbox selected at a time
    function uncheckOthers(groupName, currentCheckbox) {
      const checkboxes = document.querySelectorAll(`input[name="${groupName}"]`);
      checkboxes.forEach(checkbox => {
        if (checkbox !== currentCheckbox) {
          checkbox.checked = false;
        }})};


    // prevents the user from navigating backwards through the experiment
    history.pushState(null, document.title, location.href);
    window.addEventListener('popstate', function (event) {
      history.pushState(null, document.title, location.href);});

  </script>
</body>
</html>